# Deployments Manifest Schema

## File: `deployments.json`

This file is automatically generated and updated by GitHub Actions workflows during deployment. It contains metadata about all active branch deployments on GitHub Pages.

## Schema

```typescript
interface Deployment {
  branch: string;           // Branch name (e.g., "main", "develop", "claude/feature-x")
  path: string;             // Deployment path relative to site root (e.g., "/main/", "/develop/")
  commitSha: string;        // Full commit SHA
  commitMessage: string;    // First line of commit message
  deployedAt: string;       // ISO 8601 timestamp
  isPrimary: boolean;       // True for main branch deployment
}

interface DeploymentsManifest {
  deployments: Deployment[];
}
```

## Example

```json
{
  "deployments": [
    {
      "branch": "main",
      "path": "/main/",
      "commitSha": "c37619b8f2e3a1d4c5b6789012345678901234ab",
      "commitMessage": "Update feature implementation",
      "deployedAt": "2026-01-17T15:30:00Z",
      "isPrimary": true
    },
    {
      "branch": "develop",
      "path": "/develop/",
      "commitSha": "a1b2c3d4e5f6789012345678901234567890abcd",
      "commitMessage": "Add experimental feature",
      "deployedAt": "2026-01-17T14:20:00Z",
      "isPrimary": false
    },
    {
      "branch": "claude/feature-auth",
      "path": "/claude-feature-auth/",
      "commitSha": "9876543210fedcba0987654321fedcba09876543",
      "commitMessage": "Implement OAuth authentication",
      "deployedAt": "2026-01-17T12:45:00Z",
      "isPrimary": false
    }
  ]
}
```

## Workflow Updates

Each deployment workflow is responsible for:
1. Reading the existing `deployments.json` from the gh-pages branch (if it exists)
2. Updating or adding its deployment entry
3. Sorting deployments by `deployedAt` (newest first)
4. Writing the updated manifest to the output directory

## Notes

- Deployments are sorted by timestamp (newest first)
- The primary deployment (`isPrimary: true`) is always the main branch
- Branch names with `/` are sanitized to `-` for directory paths
- Old deployments are retained in the manifest even if their directories are removed
